<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">


<th:block layout:fragment="customCss">
 	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <!-- SweetAlert2 -->
  <link rel="stylesheet" href="plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css">
  <!-- Toastr -->
  <link rel="stylesheet" href="plugins/toastr/toastr.min.css">
   <!-- DataTables -->
  <link rel="stylesheet" href="plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
</th:block>


<th:block layout:fragment="customTitle">
	
</th:block>

<th:block layout:fragment="customScript">

</th:block>



<th:block layout:fragment="customContents">
	<!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>중고 관리</h1>
          </div>
          <div class="col-sm-6">
   			<ol class="breadcrumb float-sm-right">	
				<button type="button" class="btn btn-info btn-sm pd-x-5 pd-y-0" data-toggle="modal" data-target="#modal-lg"> 중고 입고 </button>						
			</ol>
		</div>   
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
      
      <!-- /.modal -->
      <div class="modal fade" id="modal-lg" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title">중고 입고</h4>              
            </div>
            <form action = "/usedInsert" method="post">
            <div class="modal-body">
                            
              <div th:include="used/usedInsert :: uInsert"></div>
              
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
              <input type="submit" class="btn btn-primary" value="확인">
            </div>
            </form>
            
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div> 
      
      
        <div class="row">
          <div class="col-12">
          	<div class="card">
              <div class="card-header">
                <h3 class="card-title">중고 단말기를 관리하실 수 있습니다</h3>
              </div>
              <!-- /.card-header -->
           <form action ="/usedsearchList" method="post">              
              <div class="card-body">              
                <table id="example2" class="table table-bordered table-striped">
                  <thead>
                  <div class="form-inline">                      
                  <div class="mg-b-10 mg-r-10 input-group input-group-sm wd-250">
					<input type="text" id="searchDateStart" name="searchDateStart" class="form-control" maxlength="10" placeholder="YYYY-MM-DD" > 
					-
					<input type="text" id="searchDateEnd" name="searchDateEnd" class="form-control" maxlength="10" placeholder="YYYY-MM-DD" >
				  </div>	
				  <div class="mg-b-10 mg-r-10">
					<div class='srch_area'>
					<div class="form-inline">
					  <span>
					    <input type="button" id="r_today" name="today" class="btn btn-secondary btn-sm" value="오늘" style="margin: 5px;">
					    <label for="r1" ></label>
					  </span>
					  <span>
					    <input type="button" id="r_week" name="week" class="btn btn-secondary btn-sm" value="1주일" style="margin: 5px;">
					    <label for="r2"></label>
					  </span>
					  <span>
					    <input type="button" id="r_month" name="month" class="btn btn-secondary btn-sm" value="1개월" style="margin: 5px;">
					    <label for="r3"></label>
					  </span>
					</div>
					</div>	
				</div>				  
				           
						</div>	
					<div class="form-inline">
					                  
							<select id="searchStatus" name="searchStatus" class="form-control" style="margin: 5px;" >
	                          <option value="" >보유</option>
	                          <option id="searchStatus" value="신규">신규</option>
	                          <option id="searchStatus" value="교품">교품</option>
	                          <option id="searchStatus" value="status3">철회</option>
	                          <option id="searchStatus" value="">----</option>
	                          <option id="searchStatus" value="status4">개통</option>
	                          <option id="searchStatus" value="status5">판매</option>
	                          <option id="searchStatus" value="status6">반품</option>
	                       
	                        </select>
							                      
							<select id="searchStaff" name="searchStaff" class="form-control" style="margin: 5px;">
	                          <option value="">직원</option>
	                          <option value="staff_1">직원1</option>
	                          <option value="staff_2">직원2</option>
	                        
	                        </select>

							<div id="example1_filter" class="dataTables_filter">
								<input id="searchSerial" name="searchSerial" type="search" class="form-control form-control-sm" placeholder="일련번호" aria-controls="example1">
							</div>
						
							<button type="submit" id="testbtn" class="form-control btn btn-block btn-secondary" style="margin: 5px;">검색</button>	
			
							
																		
					
							</div>
                 <tr>
                    <th>상태</th>
                    <th>입고일</th>                    
                    <th>통신사</th>
                    <th>종류</th>
                    <th>일련번호</th>
                    <th>모델명</th>
                    <th>색상</th>
                    <th>입고가</th>
                    <th>매장</th>
                    <th>직원</th>
                    <th>비고</th>
                    <th>관리</th>
                    
                         
                </tr>
                  </thead>
                  <tbody>                  
                  <tr th:each="u : ${usedList}" style="align:center">
                    <td th:text="${u.usedinStatus}"></td>
					<td th:text="${u.usedinDate}"></td>	
					<td th:text="${u.usedinTelecom}"></td>
					<td th:text="${u.deviceType}"></td>
					<td th:text="${u.usedinSerial}"></td>			            
		            <td th:text="${u.deviceModel}"></td>
		            <td	th:text="${u.deviceColor}"></td>
		            <td th:text="${u.usedinPrice}"></td>
		            <td th:text="${u.storeName}"></td>		         		              
		            <td th:text="${u.usedinStaff}"></td>	
					<td th:text="${u.usedinMemo}"></td>
                    <td align="center">
                     <button type="button" class="btn btn-info btn-sm pd-x-5 pd-y-0" id="infobtn" data-toggle="modal" data-target="#modal-Info"><i class="icon ion-ios-browsers"></i></button>
                    
                      <!-- /.modal -->
      <div class="modal fade" id="modal-Info" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title col-sm-6">중고 정보</h4>
              <div class="col-sm-6" align="right">	   			
					<button type="button" id="updatebtn" class="btn btn-info btn-sm pd-x-5 pd-y-0" style="margin:5px" data-toggle="modal" data-target="#modal-Update"><i class="fa fa-wrench"></i></button> 					
					<button type="button" id="deletebtn" class="btn btn-info btn-sm pd-x-5 pd-y-0" style="margin:5px" data-toggle="modal" data-target="#modal-Delete"><i class="fa fa-trash"></i></button>
					</div> 
             
            </div>
            <div class="modal-body">
                            
              <div th:include="used/usedInfo :: uInfo"></div>
              
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
            
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div> 
      <!-- /.modal -->
      <div class="modal fade" id="modal-Update" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title col-sm-6">중고 정보 수정</h4>              
              
            </div>
            <form action ="/usedUpdate" method="post">
            <div class="modal-body">
                            
              <div class="row mg-t-20 mg-b-20" th:include="used/usedUpdate :: uUpdate"></div>
              
            </div>
           
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">취소</button>
              <input type="submit" class="btn btn-primary" value="확인">              
            </div>
           </form>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div> 
       <!-- modal delete -->
      <div class="modal fade" id="modal-Delete" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-sm">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title col-sm-6">안내</h4>              
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
              </button>
            </div>
            <form action ="/usedDelete" method="post">            
            <div class="modal-body">      
            	<input type="hidden" name="deleteSerial" id="deleteserial"> 
            	  삭제하시겠습니까?
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">취소</button>
              <input type="submit" class="btn btn-primary" value="확인">
            </div>
            </form>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>    
                    </td>                   
                  </tr>   
                 </tbody>
                </table>
              </div>
              </form>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div>
      <!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

</th:block>
<th:block layout:fragment="customFooterScript">


<!-- DataTables -->
<script src="/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<!-- SweetAlert2 -->
<script src="/plugins/sweetalert2/sweetalert2.min.js"></script>
<!-- Toastr -->
<script src="/plugins/toastr/toastr.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="/dist/js/demo.js"></script>
<!-- page script -->
<script>
  $(function () {
    $("#example1").DataTable({
      "responsive": true,
      "autoWidth": false,
      "aaSorting":[],
      "aoColumnDefs":[
         {'bSortable': false, 'aTargets':[0,2,3,4,5,6,8,9,10,11]}
      ]
    });
    $('#example2').DataTable({
      "paging": true,
      "lengthChange": true,
      "searching": false,
      "ordering": true,
      "info": true,
      "autoWidth": false,
      "responsive": true,
      "aaSorting":[],
      "aoColumnDefs":[
         {'bSortable': false, 'aTargets':[0,2,3,4,5,6,8,9,10,11]}
      ]
      });    
     $(document).on('click','#infobtn',function(){
    	 var str = ""
 			var tdArr = new Array();	// 배열 선언
 			var infobtn = $(this);
 			// checkBtn.parent() : checkBtn의 부모는 <td>이다.
 			// checkBtn.parent().parent() : <td>의 부모이므로 <tr>이다.
 			var tr = infobtn.parent().parent();
 			var td = tr.children();
 			
 			console.log("클릭한 Row의 모든 데이터 : "+tr.text());
 			
 			var infostatus = td.eq(0).text();
 			var infodate = td.eq(1).text();
 			var infotelecom = td.eq(2).text(); 
 			var infotype = td.eq(3).text(); 
 			var infoserial = td.eq(4).text(); 
 			var infomodel = td.eq(5).text(); 
 			var infocolor = td.eq(6).text(); 
 			var infoprice = td.eq(7).text(); 
 			var infostore = td.eq(8).text(); 
 			var infostaff = td.eq(9).text(); 
 			var infomemo = td.eq(10).text();  			
 	
 			$('#infoserial').text(infoserial);
 			$('#infotelecom').text(infotelecom);
 			$('#infomodel').text(infomodel);
 			$('#infotype').text(infotype);
 			$('#infocolor').text(infocolor);
 			$('#infoprice').text(infoprice);
 			$('#infostatus').text(infostatus);
 			$('#infostore').text(infostore);
 			$('#infostaff').text(infostaff);
 			$('#infodate').text(infodate);
 			$('#infomemo').text(infomemo);
 			
    
     
   
 			 var userial = $('#infoserial').text();
 	    	 var udate = $('#infodate').text();
 	    	 
 	    	 console.log(userial +"<<userial");
 	    	 console.log(udate + "<<udate");
 	    	 
 	    	 $('#updateserial').val(userial);
 	    	 $('#updatedate').val(udate);
 	    	 
 	    	 console.log($('#updateserial').val() + "<<#updateserial");
 	    	 console.log($('#updatedate').val() + "<<#updatedate");
 	  
 	     

 	    	 
 	    	 var dserial = $('#infoserial').text();
 	    	 
 	    	 console.log(dserial + "<<dserial");
 	    	 
 	    	 $('#deleteserial').val(dserial);
 	    	 
 	    	 console.log($('#deleteserial').val() + "<<#deleteserial");
 	    	});
 	     
 	     $('#testbtn').click(function(){
 	    	 var sstatus = $('#searchStatus').val()
 	    	 console.log(sstatus);
 	     })

 	     /* 날짜 객체 받아서 문자열로 리턴하는 함수 */
 	     function getDateStr(myDate){
 	     	return (myDate.getFullYear() + '-' + (myDate.getMonth() + 1) + '-' + myDate.getDate())
 	     }

 	     /* 오늘 날짜를 문자열로 반환 */
 	     function today() {
 	       var d = new Date()
 	       return getDateStr(d)
 	     }

 	     /* 오늘로부터 1주일전 날짜 반환 */
 	     function lastWeek() {
 	       var d = new Date()
 	       var dayOfMonth = d.getDate()
 	       d.setDate(dayOfMonth - 7)
 	       return getDateStr(d)
 	     }

 	     /* 오늘로부터 1개월전 날짜 반환 */
 	     function lastMonth() {
 	       var d = new Date()
 	       var monthOfYear = d.getMonth()
 	       d.setMonth(monthOfYear - 1)
 	       return getDateStr(d)
 	     }
 	     $(".srch_area :button").click(function(){
 	       var rname = $(this).attr("name")
 	       $("#searchDateEnd").val(today())
 	     	if( rname == "today"){
 	         $("#searchDateStart").val(today())
 	       }else if(rname == "week") {
 	       	$("#searchDateStart").val(lastWeek())
 	       }else{
 	       	$("#searchDateStart").val(lastMonth())
 	       }
 	     })  

  });  
  
</script>



</th:block>





</html>