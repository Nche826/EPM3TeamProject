<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cafe24.epm.mapper.DeviceMapper">

	
	<resultMap type="Device" id="DeviceinSelect">
		<result property="deviceinCode" 			column="devicein_code"/>
		<result property="deviceinSerial"			column="devicein_serial"/>
		<result property="deviceinDealler"			column="dealler_code"/>
		<result property="deviceinDevice"			column="device_code"/>
		<result property="deviceinStatus"			column="devicein_status"/>
		<result property="deviceinStatDate"			column="devicein_stat_date"/>
		<result property="deviceinDate"				column="devicein_date"/>
		<result property="deviceinMemo"				column="devicein_memo"/>
		<result property="deviceinStaff"			column="staff_code"/>
		<result property="deviceinRegDate"			column="devicein_reg_date"/>
		
		<result property="deviceCode"				column="device_code"/>
		<result property="deviceType"				column="device_type"/>
		<result property="deviceManuf"				column="device_manuf"/>
		<result property="deviceModel"				column="device_model"/>
		<result property="deviceName"				column="device_name"/>
		<result property="deviceColor"				column="device_color"/>
		<result property="devicePrice"				column="device_price"/>
		<result property="memberId"					column="member_id"/>
		<result property="deviceRegDate"			column="device_reg_date"/>
		<result property="deviceTelecom"			column="device_telecom"/>
		
		<result property="storeName"				column="store_name"/>
		
		<result property="infoDevicein"				column="dinfo_devicein"/>
		<result property="infoMethod"				column="dinfo_method"/>
		<result property="infoStore"				column="dinfo_store"/>		
		<result property="infoMemo"					column="dinfo_memo"/>
		<result property="infoRegDate"				column="dinfo_reg_date"/>
	</resultMap>

	<select id = "getDeviceSelect" parameterType="String" resultMap="DeviceinSelect">
	SELECT
		devicein_code
		,devicein_serial
		,dealler_code
		,device_code
		,devicein_status
		,devicein_stat_date
		,devicein_date
		,devicein_memo
		,staff_code
		,devicein_reg_date
	FROM
		tb_devicein		
	WHERE
		devicein_serial = #{deviceinSerial}
	</select>
		
	<select id = "deviceList" parameterType="String" resultMap="DeviceinSelect">
	SELECT
	*
	FROM
		tb_devicein AS i
	join tb_device  AS d
		on 	i.device_code = d.device_code
	JOIN tb_staff AS s
	 	ON i.staff_code = s.staff_code
	JOIN tb_store AS a
		ON s.store_code = a.store_code
	JOIN tb_deviceinfo as info
		on info.dinfo_devicein = i.devicein_code
	</select>	

	<insert id="deviceInsert" parameterType="Device">
	
INSERT
	into tb_devicein
			(
			devicein_code
			,devicein_serial
			,dealler_code
			,device_code
			,devicein_status
			,devicein_stat_date
			,devicein_date
			,devicein_memo
			,staff_code
			,devicein_reg_date
			)
			values
			(
			'code3'
			,1
			,'dealler_1'
			,'CODE1'
			,'신규'
			,now()
			,now()
			,1
			,'staff_1'
			,now()		
			)		
		</insert>
		<insert id="deviceInfoInsert" parameterType="Device">	
	INSERT		
		into tb_deviceinfo
			(
			dinfo_code
			,dinfo_devicein
			,dinfo_method
			,dinfo_store
			,dinfo_memo
			,dinfo_reg_date
			)			
			values
			(
			'code3'
			,'code3' 
			,1
			,1
			,1
			,now()
			)	
	
		</insert>
		
		<update id="deviceInfoUpdate" parameterType="Device">	
	update		
		tb_deviceinfo
			(
			dinfo_code
			,dinfo_devicein
			,dinfo_method
			,dinfo_store
			,dinfo_memo
			,dinfo_reg_date
			)			
			values
			(
			'code3'
			,'code3' 
			,1
			,1
			,1
			,now()
			)		
		</update>
		
		<update id="deviceUpdate" parameterType="Device">
	
update
	tb_devicein
			(
			,devicein_serial
			,dealler_code
			,device_code
			,devicein_date
			,devicein_memo
			,staff_code
			,devicein_reg_date
			)
			values
			(
			,#{deviceinSerial}
			,#{deviceinDealler}
			,#{deviceinDevice}'
			,now()
			,#{deviceinMemo}
			,#{deviceinStaff}
			,now()		
			)		
		</update>
</mapper>
	
