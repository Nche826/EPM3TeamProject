<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">


<th:block layout:fragment="customCss">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="../../plugins/fontawesome-free/css/all.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- SweetAlert2 -->
  <link rel="stylesheet" href="../../plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css">
  <!-- Toastr -->
  <link rel="stylesheet" href="../../plugins/toastr/toastr.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../dist/css/adminlte.min.css">
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
   <!-- DataTables -->
  <link rel="stylesheet" href="../../plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="../../plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../dist/css/adminlte.min.css">
</th:block>


<th:block layout:fragment="customTitle">
	
</th:block>

<th:block layout:fragment="customScript">

</th:block>



<th:block layout:fragment="customContents">
	<!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>홈상품</h1>
          </div>
          <div class="col-sm-6">
   			<div class="breadcrumb float-sm-right">
			　	<a href="/openHomeInsert" class="btn btn-info btn-sm pd-x-5 pd-y-0"><i class="fas fa-pen" ></i> 홈상품 개통</a>		
								
			</div>
		</div>   
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">      
      
	<div class="row">
          <div class="col-12">
          	<div class="card">
              <div class="card-header">
                <h3 class="card-title">홈상품 개통과 관련된 모든 업무를 관리하실 수 있습니다.</h3>
              </div>
              <!-- /.card-header -->
            <form action ="/searchList" method="post">    
             <div class="card-body">              
                <table id="example2" class="table table-bordered table-striped">
                  <thead>
                  <div class="form-inline">                      
                  <div class="mg-b-10 mg-r-10 input-group input-group-sm wd-250">
					<input type="text" id="searchDateStart" name="searchDateStart" class="form-control" maxlength="10" placeholder="YYYY-MM-DD" > 
					-
					<input type="text" id="searchDateEnd" name="searchDateEnd" class="form-control" maxlength="10" placeholder="YYYY-MM-DD" >
				  </div>	
				  <div class="mg-b-10 mg-r-10">
					<div class='srch_area'>
					<div class="form-inline">
					  <span>
					    <input type="button" id="r_today" name="today" class="btn btn-secondary btn-sm" value="오늘" style="margin: 5px;">
					    <label for="r1" ></label>
					  </span>
					  <span>
					    <input type="button" id="r_week" name="week" class="btn btn-secondary btn-sm" value="1주일" style="margin: 5px;">
					    <label for="r2"></label>
					  </span>
					  <span>
					    <input type="button" id="r_month" name="month" class="btn btn-secondary btn-sm" value="1개월" style="margin: 5px;">
					    <label for="r3"></label>
					  </span>
					</div>
					</div>	
				</div>	
					  
				           
						</div>	
					<div class="form-inline">
					                  
							<select id="searchStatus" name="searchStatus" class="form-control" style="margin: 5px;" >
	                          <option value="">상태</option>
	                          <option value="">예약</option>
	                          <option value="">신청</option>
	                          <option value="">완료</option>
	                          <option value="">철회</option>
	                        </select>
							<select id="searchType" class="form-control" style="margin: 5px;">
	                          <option value="">구분</option>
	                          <option value="">단품판매</option>
	                          <option value="">결합판매</option>
	                          <option value="">동시판매</option>
	                        </select>	                        
							<select id="searchStaff" name="searchStaff" class="form-control" style="margin: 5px;">
	                          <option value="">직원</option>
	                          <option value="">직원1</option>
	                          <option value="">직원2</option>
	                          <option value="">직원3</option>
	                          <option value="">직원4</option>
	                        </select>

							<div id="example1_filter" class="dataTables_filter">
								<input id="searchPhone" type="search" class="form-control form-control-sm" placeholder="" aria-controls="example1">
							</div>						
							<button type="submit" id="testbtn" class="form-control btn btn-block btn-secondary" style="margin: 5px;">검색</button>	
													
							</div>
                 <tr>
                    <th>상태</th>
                    <th>신청일</th>
                    <th>거래처</th>
                    <th>고객명</th>
                    <th>연락처</th>
                    <th>구분</th>
                    <th>가입상품</th>
                    <th>정산금액</th>
                    <th>실판매마진</th>
                    <th>매장</th>
                    <th>직원</th>
                    <th>비고</th>
                    <th>관리</th>
                   <!--  <th style="visibility:hidden;position:absolute;"></th>     -->
                </tr>
                  </thead>
                  <tbody> 
                 <tr th:each="h : ${openHomeList}" style="align:center">                 
					<td	th:text="${h.openHomeStatus}"></td>	
					<td th:text="${h.openHomeDate}"></td>	
					<td th:text="${h.openHomeDealler}"></td>	
					<td th:text="${h.openHomeCustomer}"></td>
					<td th:text="${h.openHomePhone}"></td>
					<td th:text="${h.openHomeType}"></td>			            
		            <td th:text="${h.openHomeName}"></td>
		            <td	th:text="${h.openHomePrice}"></td>
		            <td th:text="${h.openHomeMargin}"></td>
		            <td th:text="${h.storeName}"></td>		         		              
		            <td th:text="${h.openHomeRStaff}"></td>           								
		            <td th:text="${h.openHomeMemo}"></td>           								
					<td align="center">
	                    <button type="button" class="btn btn-info btn-sm pd-x-5 pd-y-0" id="infobtn" data-toggle="modal" data-target="#modal-Info"><i class="icon ion-ios-browsers"></i></button>
	       			<!-- <td style="visibility:hidden;position:absolute;"></td> -->  	
                      <!-- /.modal -->
      <div class="modal fade" id="modal-Info" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title col-sm-6">홈상품 가입 정보</h4>
              <div class="col-sm-6" >	   			
					<button type="button" id="updatebtn" class="btn btn-info btn-sm pd-x-5 pd-y-0" style="margin:5px" data-toggle="modal" data-target="#modal-Update"><i class="fa fa-wrench"></i></button> 					
					<button type="button" id="deletebtn" class="btn btn-info btn-sm pd-x-5 pd-y-0" style="margin:5px" data-toggle="modal" data-target="#modal-Delete"><i class="fa fa-trash"></i></button>
					</div> 
           
            </div>
            <div class="modal-body">
                            
              <div th:include="open/openHomeInfo :: oInfo"></div>
              
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>      
                    </td>                   
                  </tr>   
                 </tbody>
                </table>
              </div>
              </form>
               <!-- modal update -->
      <div class="modal fade" id="modal-Update" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title col-sm-6">홈상품 가입 정보 수정</h4>    
           
            </div>
         	<form action ="/openHomeUpdate" method="post">
            <div class="modal-body">
              <div class="row mg-t-20 mg-b-20" th:include="open/openHomeUpdate :: oUpdate"></div>
              
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">취소</button>
              <input type="submit" class="btn btn-primary" value="확인">              
            </div>
            </form>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      
       <!-- modal delete -->
      <div class="modal fade" id="modal-Delete" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-sm">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title col-sm-6">안내</h4>              
              
            </div>
            <form action ="/openHomeDelete" method="post">            
            <div class="modal-body"> 
            	<input type="hidden" name="deletePhone" id="deletephone"> 
            	  삭제하시겠습니까?
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-default" data-dismiss="modal">취소</button>
              <button type="button" class="btn btn-primary">확인</button>
            </div>
            </form>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>  
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div>
      <!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

</th:block>
<th:block layout:fragment="customFooterScript">

<!-- Bootstrap 4 -->
<script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- DataTables -->
<script src="/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<!-- AdminLTE App -->
<script src="/dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="/dist/js/demo.js"></script>
<!-- page script -->
<script>
  $(function () {
    $("#example1").DataTable({
      "responsive": true,
      "autoWidth": false,
      "aaSorting":[],
      "aoColumnDefs":[
         {'bSortable': false, 'aTargets':[0,2,3,4,5,6,9,10,11]}
      ]
    });
    $('#example2').DataTable({
      "paging": true,
      "lengthChange": false,
      "searching": false,
      "ordering": true,
      "info": true,
      "autoWidth": false,
      "responsive": true,
      "aaSorting":[],
      "aoColumnDefs":[
         {'bSortable': false, 'aTargets':[0,2,3,4,5,6,9,10,11]}
      ]
      
    });
    $(document).on('click','#infobtn',function(){
   	 var str = ""
			var tdArr = new Array();	// 배열 선언
			var infobtn = $(this);
			// checkBtn.parent() : checkBtn의 부모는 <td>이다.
			// checkBtn.parent().parent() : <td>의 부모이므로 <tr>이다.
			var tr = infobtn.parent().parent();
			var td = tr.children();
			
			console.log("클릭한 Row의 모든 데이터 : "+tr.text());
			
			var infostatus = td.eq(0).text();
			var infodate = td.eq(1).text();
			var infodealler = td.eq(2).text();
			var infocustomer = td.eq(3).text(); 
			var infophone = td.eq(4).text(); 
			var infotype = td.eq(5).text(); 
			var infoname = td.eq(6).text(); 
			var infoprice = td.eq(7).text(); 
			var infomargin = td.eq(8).text(); 
			var infostore = td.eq(9).text(); 
			var infostaff = td.eq(10).text(); 
			var infomemo = td.eq(11).text();  			
			var inforegdate = td.eq(12).text();
		
            
			$('#infostatus').text(infostatus);
			$('#infodate').text(infodate);
			$('#infodealler').text(infodealler);
			$('#infocustomer').text(infocustomer);
			$('#infophone').text(infophone);
			$('#infotype').text(infotype);
			$('#infoname').text(infoname);
			$('#infoprice').text(infoprice);
			$('#infomargin').text(infomargin);
			$('#infostore').text(infostore);
			$('#infostaff').text(infostaff);
			$('#infomemo').text(infomemo);
			$('#inforegdate').text(inforegdate);
			
   
    
  
   	 
   	 var userial = $('#infophone').text();
   	 var udate = $('#infodate').text();
   	 
   	 console.log(uphone +"<<uphone");
   	 console.log(udate + "<<udate");
   	 
   	 $('#updatephone').val(uphone);
   	 $('#updatedate').val(udate);
   	 
   	 console.log($('#updatephone').val() + "<<#updatephone");
   	 console.log($('#updatedate').val() + "<<#updatedate");
 
    

   	 
   	 var dphone = $('#infophone').text();
   	 
   	 console.log(dphone + "<<dphone");
   	 
   	 $('#deletephone').val(dphone);
   	 
   	 console.log($('#deletephone').val() + "<<#deletephone");
   	});
    
    $('#testbtn').click(function(){
   	 var sstatus = $('#searchStatus').val()
   	 console.log(sstatus);
    })

    /* 날짜 객체 받아서 문자열로 리턴하는 함수 */
    function getDateStr(myDate){
    	return (myDate.getFullYear() + '-' + (myDate.getMonth() + 1) + '-' + myDate.getDate())
    }

    /* 오늘 날짜를 문자열로 반환 */
    function today() {
      var d = new Date()
      return getDateStr(d)
    }

    /* 오늘로부터 1주일전 날짜 반환 */
    function lastWeek() {
      var d = new Date()
      var dayOfMonth = d.getDate()
      d.setDate(dayOfMonth - 7)
      return getDateStr(d)
    }

    /* 오늘로부터 1개월전 날짜 반환 */
    function lastMonth() {
      var d = new Date()
      var monthOfYear = d.getMonth()
      d.setMonth(monthOfYear - 1)
      return getDateStr(d)
    }
    $(".srch_area :button").click(function(){
      var rname = $(this).attr("name")
      $("#searchDateEnd").val(today())
    	if( rname == "today"){
        $("#searchDateStart").val(today())
      }else if(rname == "week") {
      	$("#searchDateStart").val(lastWeek())
      }else{
      	$("#searchDateStart").val(lastMonth())
      }
    })   
  });  
  <!-- modal script -->
  var product = new Array();
  $(function(){
  	$(".fc-datepicker").datepicker();
  	
  	$("#product1").click(function(){
  		if($(this).is(":checked") == true){
  			$(".product1").show();
  			product.push(1);
  		}else{
  			$(".product1").hide();
  			product.splice(product.indexOf(1),1);
  		}
  		setProduct();
  	});
  	$("#product2").click(function(){
  		if($(this).is(":checked") == true){
  			$(".product2").show();
  			product.push(2);
  		}else{
  			$(".product2").hide();
  			product.splice(product.indexOf(2),1);
  		}
  		setProduct();
  	});
  	
  	$("#product6").click(function(){
  		if($(this).is(":checked") == true){
  			$(".product6").show();
  			product.push(6);
  		}else{
  			$(".product6").hide();
  			product.splice(product.indexOf(6),1);
  		}
  		setProduct();
  	});
  	
  	
  	$(".product_num").change(function(){
  		setProductNum($(this).attr("rel"));
  	});
  	
  	$("#option1").click(function(){
  		if($(this).is(":checked") == true) $(".option1").show();
  		else{
  			$(".option1").hide();
  			$("#form-write input[name=saleprice]").val("");
  			$("#form-write input[name=saleday]").val("");
  			$("#form-write input[name=saledate]").val("");
  			$("#form-write input[name=salememo]").val("");
  			setPending();
  			calc();
  		}
  	});
  	
  	$("#option2").click(function(){
  		if($(this).is(":checked") == true) $(".option2").show();
  		else{
  			$(".option2").hide();
  			$("#form-write input[name=indoc]").val("");
  			$("#form-write input[name=indocday]").val("");
  			$("#form-write input[name=indocdate]").val("");
  			$("#form-write input[name=indocmemo]").val("");
  			setPending();
  		}
  	});
  	
  	$("#option3").click(function(){
  		if($(this).is(":checked") == true) $(".option3").show();
  		else{
  			$(".option3").hide();
  			removeFile(1);
  			removeFile(2);
  			removeFile(3);
  		}
  	});
  	
  	$("#option4").click(function(){
  		if($(this).is(":checked") == true) $(".option4").show();
  		else{
  			$(".option4").hide();
  			$("#form-write input[name=plusprice]").val("");
  			$("#form-write input[name=plusinfo]").val("");
  		}
  	});
  	
  	$("#form-write input[name=saledate], #form-write input[name=indocdate]").change(function(){
  		setPending();
  	});
  	
  	$("#form-write input[name=salememo], #form-write input[name=indocmemo]").keyup(function(){
  		setPending();
  	});
  	
  	$("#keepcalc input[name=keepplus").keyup(function(){
  		var cdate = calcDate($("#keepcalc input[name=keepdate]").val(), $("#keepcalc input[name=keepplus]").val());
  		$("#keepcalc input[name=keepresult]").val(cdate);
  	});
  	
  	$("#form-write input[name=saleday]").keyup(function(){
  		var cdate = calcDate($("#form-write input[name=reportdate]").val(), $("#form-write input[name=saleday]").val());
  		$("#form-write input[name=saledate]").val(cdate);
  		setPending();
  	});
  	$("#form-write input[name=saledate]").change(function(){
  		$("#form-write input[name=saleday]").val("");
  	});
  	
  	$("#form-write input[name=indocday]").keyup(function(){
  		var cdate = calcDate($("#form-write input[name=reportdate]").val(), $("#form-write input[name=indocday]").val());
  		$("#form-write input[name=indocdate]").val(cdate);
  		setPending();
  	});
  	$("#form-write input[name=indocdate]").change(function(){
  		$("#form-write input[name=indocday]").val("");
  	});
  	
  	$(".calcprice").keyup(function(){
  		calc();
  	})
  	.focusout(function(){
  		calc();
  	});

  	var bannerOffset = $("#form-write-banner").offset();
  	$(window).scroll(function(){
  		var scr = $(window).scrollTop();
  		var newPosition = scr + 80 + "px";
  		if(scr > 90) $("#form-write-banner").stop().animate({"top" : newPosition}, 500);
  		else $("#form-write-banner").stop().animate({"top" : bannerOffset.top}, 500);
  	});
  	
  	$(".inputfile").each(function(){
  		var $input = $( this ),
  			$label	 = $input.next("label"),
  			labelVal = $label.html();

  		$input.on("change", function(e){
  			var fileName = "";

  			if(this.files && this.files.length > 1)
  				fileName = (this.getAttribute("data-multiple-caption") || "").replace("[count]", this.files.length);
  			else if(e.target.value)
  				fileName = e.target.value.split("\\").pop();

  			if(fileName){
  				$label.find("span").html( fileName );
  				$label.find("a.btn").show();
  			}else{
  				$label.html( labelVal );
  				$label.find("a.btn").hide();
  			}
  		});

  		$input
  		.on("focus", function(){ $input.addClass("has-focus"); })
  		.on("blur", function(){ $input.removeClass("has-focus"); });
  	});
  });

  function setProduct()
  {
  	if(product.length > 0) $(".product0").hide();
  	else $(".product0").show();
  	calc();
  }

  function setProductNum(gubun)
  {
  	var num = $("#form-write select[name=p"+gubun+"_num]").val();
  	$(".product"+gubun+"_plus").hide();
  	if(num > 1){
  		for(i=1;i<=num;i++) $(".product"+gubun+"_"+i).show();
  	}
  	calc();
  }

  function setPending()
  {
  	var pending = "";
  	
  	var saledate = $("#form-write input[name=saledate]").val();
  	var salememo = $("#form-write input[name=salememo]").val();
  	if(saledate){
  		pending += '<li class="list-group-item bd-0 pd-x-0">';
  		if(salememo) pending += '	<div class="pull-right"><i class="fa fa-envelope-o" data-toggle="tooltip" data-placement="left" title="'+salememo.replace(/\"/g,"&quot;")+'"></i></div>';
  		pending += '	<p class="mg-b-0"><i class="fa fa-check tx-success mg-r-8"></i><strong class="tx-inverse tx-medium">할인예정</strong> <span class="text-muted mg-l-5">'+saledate+'</span></p>';
  		pending += '</li>';
  	}
  	
  	var indocdate = $("#form-write input[name=indocdate]").val();
  	var indocmemo = $("#form-write input[name=indocmemo]").val();
  	if(indocdate){
  		pending += '<li class="list-group-item bd-0 pd-x-0">';
  		if(indocmemo) pending += '	<div class="pull-right"><i class="fa fa-envelope-o" data-toggle="tooltip" data-placement="left" title="'+indocmemo.replace(/\"/g,"&quot;")+'"></i></div>';
  		pending += '	<p class="mg-b-0"><i class="fa fa-check tx-success mg-r-8"></i><strong class="tx-inverse tx-medium">미비약속</strong> <span class="text-muted mg-l-5">'+indocdate+'</span></p>';
  		pending += '</li>';
  	}
  	
  	if(pending){
  		$("#list-pending").html(pending);
  		$("#form-write-pending1").hide();
  		$("#form-write-pending2").show();
  		$('[data-toggle="tooltip"]').tooltip();
  	}else{
  		$("#list-pending").html("");
  		$("#form-write-pending1").show();
  		$("#form-write-pending2").hide();
  	}
  }

  function removeFile(n)
  {
  	var $input = $("#file"+n),
  		$label	 = $input.next("label"),
  		labelVal = $label.html();
  	
  	$input.val("");
  	$label.find("span").html('파일 선택 '+n);
  	$label.find("a.btn").hide();
  }

  function calc()
  {
  	var s_basicprice = 0;
  	var s_giftprice = 0;
  	if($("#form-write input[name=product1]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p1_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p1_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p1_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product2]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p2_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p2_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p2_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  		if(p_num >= 2){
  			var p_basicprice = $("#form-write input[name=p2_2_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p2_2_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  		if(p_num >= 3){
  			var p_basicprice = $("#form-write input[name=p2_3_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p2_3_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product3]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p3_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p3_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p3_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product4]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p4_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p4_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p4_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product5]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p5_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p5_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p5_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product6]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p6_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p6_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p6_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product7]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p7_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p7_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p7_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product8]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p8_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p8_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p8_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	if($("#form-write input[name=product9]").is(":checked") == true){
  		var p_num = $("#form-write select[name=p9_num]").val();
  		if(p_num >= 1){
  			var p_basicprice = $("#form-write input[name=p9_1_basicprice]").val();
  			if(p_basicprice) p_basicprice = parseInt(p_basicprice); else p_basicprice = 0;
  			var p_giftprice = $("#form-write input[name=p9_1_giftprice]").val();
  			if(p_giftprice) p_giftprice = parseInt(p_giftprice); else p_giftprice = 0;
  			s_basicprice += p_basicprice;
  			s_giftprice += p_giftprice;
  		}
  	}
  	$("#form-write input[name=basicprice]").val(s_basicprice);
  	$("#form-write input[name=giftprice]").val(s_giftprice);
  	
  	var sumprice = 0;
  	var marginprice = 0;
  	var realmargin = 0;
  	
  	var basicprice = $("#form-write input[name=basicprice]").val();
  	if(basicprice) basicprice = parseInt(basicprice); else basicprice = 0;
  	var profitprice = $("#form-write input[name=profitprice]").val();
  	if(profitprice) profitprice = parseInt(profitprice); else profitprice = 0;
  	var giftprice = $("#form-write input[name=giftprice]").val();
  	if(giftprice) giftprice = parseInt(giftprice); else giftprice = 0;
  	var saleprice = $("#form-write input[name=saleprice]").val();
  	if(saleprice) saleprice = parseInt(saleprice); else saleprice = 0;
  	var plusprice = $("#form-write input[name=plusprice]").val();
  	if(plusprice && plusprice != "-") plusprice = parseInt(plusprice); else plusprice = 0;
  	
  	sumprice = basicprice + profitprice - giftprice;
  	sumprice *= -1;
  	
  	marginprice = basicprice + profitprice - giftprice - saleprice + plusprice;
  	
  	realmargin = marginprice;
  realmargin -= Math.round((sumprice - (sumprice/(1+10.00/100))) * -1);
  	
  	$("#form-write input[name=sumprice]").val(sumprice);
  	$("#form-write input[name=marginprice]").val(marginprice);
  	$("#form-write input[name=realmargin]").val(realmargin);
  }

  function writeHome()
  {
  	$("#form-write").ajaxSubmit({
  		url: "/open/writeHome",
  		type: "POST",
  		dataType: "json",
  		success: function(response){
  			$("#loading").hide();
  			if(response.msg) $.alert(response.msg);
  			if(response.result == 1) $(location).attr("href","/open/home");
  			if(response.result == 2) history.go(0);
  		},
  		beforeSerialize: function(){ $("#loading").show(); },
  		error: function(){ $("#loading").hide(); }
  	});
  }

  function emptyInput(n)
  {
  	$("#form-write input[name="+n+"]").val("");
  }

  function setPlanmon(a, b)
  {
  	var planmon = $("#form-write select[name=p"+a+"_"+b+"_planmon]").val();
  	
  	if(planmon == "ETC"){
  		$("#form-write-p"+a+"_"+b+"_planmon1").removeClass("wd-100p");
  		$("#form-write-p"+a+"_"+b+"_planmon1").addClass("wd-50p");
  		$("#form-write-p"+a+"_"+b+"_planmon2").show();
  		$("#form-write input[name=p"+a+"_"+b+"_planmon_etc]").select();
  	}else{
  		$("#form-write-p"+a+"_"+b+"_planmon1").removeClass("wd-50p");
  		$("#form-write-p"+a+"_"+b+"_planmon1").addClass("wd-100p");
  		$("#form-write-p"+a+"_"+b+"_planmon2").hide();
  	}
  }
</script>

<!-- SweetAlert2 -->
<script src="/plugins/sweetalert2/sweetalert2.min.js"></script>
<!-- Toastr -->
<script src="/plugins/toastr/toastr.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="/dist/js/demo.js"></script>

</th:block>





</html>